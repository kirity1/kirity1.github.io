---
key:
title: '고유벡터와 주성분 분석, 공분산행렬의 이해'
excerpt: '고유벡터와 공분산행렬'
tags: [선형대수학]
---

## 1.고유 벡터

먼저, 선형 변환이라는것은 어떠한 벡터v를 행렬에 곱하면 다른 벡터 b로 변한다고 배웠다,
$$
Av = b
$$
 ![image-20240529145116636](https://raw.githubusercontent.com/kirity1/blogimg/master/uPic/image-20240529145116636.png)
$$
A = 
\begin{bmatrix}
1 & 3 \\
2 & 0
\end{bmatrix}
, x_1=\begin{bmatrix}
1 \\
3
\end{bmatrix},
x_2=\begin{bmatrix}
3 \\
2
\end{bmatrix}
$$
 두 벡터를 가져다 행렬 A에 연산하면 저렇게 화살표가 변하는데, x_2벡터같은 경우에는 이 행렬에 선형 변환을 하여도 **같은 방향**을 바라보고 있다, 즉 행렬 A가 벡터를 투영하는 방향(변환)과 이 벡터의 행렬의 의해서 변하는 방향이 같기 때문이다. 
$$
Ax = λx
$$
이러한 벡터들을 행렬A의 고유벡터라고 한다, 람다는 고유값으로 그 벡터가 같게 해주는 숫자다. 그 말은 이름대로 고유하기에 행렬의 고유벡터는 그 행렬의 방향을 나타낸다. 즉 고유벡터는 **행렬을 나타내는,** 행렬을 분해해서 데이터를 줄이는곳에, 즉 행렬의 정보를 압축해서 표현하는 것에 목표가 있다.

![image-20240529151621227](https://raw.githubusercontent.com/kirity1/blogimg/master/uPic/image-20240529151621227.png)

어떤 이미지가 있다고 해보자, 가로 640,세로 480픽셀로 이루어져 있다, 여기서 특징(기술자)를 추출한다고 하면 특징벡터만 무려 640X480차원으로 이루어진 행렬이 됀다, 이걸 다루기엔 너무나 연산이 많이 필요하다. 물론 다양한 특징 검출 알고리즘들을 돌려서 차원이 줄어들거나 그럴 수도 있지만, 그래도 아득히 많은 차원에서 놀거다, 그러므로 우리는 이것을 차원을 압축시켜 연산량을 줄이고자 하는 목표의식에서 시작한다. 즉 대각행렬화가 할 수 있다.

## 2.주성분분석

즉 이러한 목표의식에서 나온게, 데이터를 인공신경망에 넣던가 하기전에 전처리과정으로 이 주성분분석(PCA)을 하는거다, 우리는 앞서 선형독립을 배우면서, 행렬이 3X3이라면 3차원의 각각의 수직인 축이 3개 있다는걸 알 수 있었다, 고유벡터 또한, 이와 똑같이 행렬이 3X3이면 고유벡터가 각각에 수직인 3개의 축이 있다.

![image-20240529154205756](https://raw.githubusercontent.com/kirity1/blogimg/master/uPic/image-20240529154205756.png)

여기서도 수직인걸 볼 수 있다. 그렇다면, 이러한 주성분들로 고차원으로 이루어진 데이터 중 중요한 차원을 고른다면, '축'을 찾는다면 그 축으로만 데이터(벡터)를 나열하면 차원이 훨씬 낮아진다는 아이디어이다, 그렇다면, **가장 중요한 차원**이라는건 무슨 의미일까, 여기선 차원이 낮아지는 압축과정중에서 가장 **정보손실**이 덜 되게 만드는 축이 될 것이다, 즉 데이터의 분산이 가장 큰 값을 가지는(데이터의 정보를 가장 많이 담을 수 있는) 축이라는 의미다. 이미지를 보다싶이 대충 magnitude라는 고유값으로 수치를 비교한다는걸 어렴풋이 알 수 있다, 그러므로 빨간색 화살표 방향이 데이터를 가장 잘 나타내주는 축이 될거다. 수식으로 어떻게 정확히 구해볼까?

## 3. 공분산행렬

먼저 공분산이란, 어떤 두 확률 변수 X, Y가 있을 때, 두 변수 사이에 **어떤 상관관계가 있는지**를 알기 위해 사용하는 수학식이다.

![image-20240529155559306](https://raw.githubusercontent.com/kirity1/blogimg/master/uPic/image-20240529155559306.png) 

대충 이런 느낌의 식인데

공분산은 값의 범위가 정해져 있지 않아서 어떤 값을 기준으로 정하기 애매하다는 단점이 있다. 때문에 공분산의 값을 정규화하여 특정 범위에서만 나오게 하는 것이 상관계수(correlation)이다.   

![image-20240529155651788](https://raw.githubusercontent.com/kirity1/blogimg/master/uPic/image-20240529155651788.png)

A는 양의 상관관계, 변수 x가 오르면 변수 y도 오른다는 의미고, b는 음의 상관관계로 반대고, c는 0으로 그냥 둘이 아무런 관계가 없다는 뜻이다.

그렇다면 공분산행렬은? 변수는 벡터로, 그 후 나오는 공분산 관계들을 원소로 갖는 행렬형태로 표현 한 것이다.

![image-20240529162043475](https://raw.githubusercontent.com/kirity1/blogimg/master/uPic/image-20240529162043475.png)

보다싶이 이미지의 특징벡터들을 모아놓은 벡터집합X에 대하여, 공분산행렬은 이렇게 표현됀다, 식을 관찰해보면 알 수 있는 부분인데, 대각성분들은 var, 즉 분산이고 대각성분이 아닌 나머지 성분들이 공분산형태를 띄고 있다. 식을 생각해보면 당연한 이야기이다. 결론을 말하자면 이미지 각각의 특징벡터들의 관계성을 모아놓은 데이터다. 그리고 이 **공분산 행렬에 고유벡터를 찾는 것은 데이터가 어떤 방향으로 분산이 큰지를 구하는 것과 같다는 의미**이다. 



그렇다면 고유값은 그 축(주성분)에 투영된 데이터의 **분산의 크기(정보량)**를 나타낸다. 즉, 고유값이 클수록 그 축이 데이터를 더 많이 설명한다는 뜻이다를 나타낸다, 즉 고유값이 큰 순서대로 고유벡터들을 정렬하면, 결과적으로 중요한 순서대로 주성분을 구할 수 있다는 의미다. 이 행렬에 주성분분석을 이용하여 압축시키자는게 우리의 목표였다.

![image-20240529163205690](https://raw.githubusercontent.com/kirity1/blogimg/master/uPic/image-20240529163205690.png)

이렇게 (1,1)이라는 고유벡터의 축 하나를 기준으로 모든 데이터들(여기선 파란 점)이 저 축으로 표현 되는 모습을 나타낸거다, 그리고 그 축을 구하는 방법이 앞에 쭉 이야기한 공분산행렬의 고유값을 기준으로 고유벡터를 정렬하여 가장 큰값을 고른것이다.

![image-20240529164214360](https://raw.githubusercontent.com/kirity1/blogimg/master/uPic/image-20240529164214360.png)

3차원에서 한 모습이다.

출처: https://m.blog.naver.com/dusrnwk/221683976650 , https://blog.naver.com/PostView.naver?blogId=waterforall&logNo=222789143718
